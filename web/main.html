<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Room Admin</title>
<style>
  body {
    background: #0f1117;
    color: #e5e7eb;
    font-family: system-ui, monospace;
    padding: 24px;
  }
  h2 {
    margin-top: 32px;
    font-size: 16px;
    color: #9ca3af;
  }
  input, button {
    background: #1f2937;
    color: #e5e7eb;
    border: 1px solid #374151;
    padding: 8px;
    margin: 4px 0;
  }
  button {
    cursor: pointer;
  }
  pre {
    background: #020617;
    padding: 12px;
    border: 1px solid #1e293b;
    margin-top: 12px;
  }
</style>
</head>
<body>

<h1>Room Admin</h1>

<h2>Create Room</h2>
<input id="roomId" placeholder="room id">
<button onclick="createRoom()">Create</button>

<h2>Add User to Room</h2>
<input id="addRoomId" placeholder="room id">
<input id="userInput" placeholder="userId or email">
<input id="role" placeholder="role (0-3)">
<button onclick="addUser()">Add</button>

<h2>Room Users</h2>
<input id="viewRoomId" placeholder="room id">
<button onclick="loadUsers()">Load</button>

<pre id="output"></pre>

<script>
const out = document.getElementById("output")

async function createRoom() {
  const roomId = document.getElementById("roomId").value
  const res = await fetch("/api/create-room", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ roomId })
  })
  out.textContent = await res.text()
}

async function addUser() {
  const roomId = document.getElementById("addRoomId").value
  const user   = document.getElementById("userInput").value
  const role   = Number(document.getElementById("role").value)

  const res = await fetch("/add-user", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      roomId,
      user,   // email or userId
      role,
    }),
  })

  out.textContent = await res.text()
}


async function loadUsers() {
  const roomId = document.getElementById("viewRoomId").value
  const res = await fetch(`/get-users?roomId=${roomId}`)
  out.textContent = JSON.stringify(await res.json(), null, 2)
}
</script>

</body>
</html>
